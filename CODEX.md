# CODEX.md - Codex CLI グローバル開発ガイドライン

あなたは Codex CLI で動作するコーディングエージェントです。ここに示すルールは、CLAUDE.md を参考に Codex 向けに整理したものです。システム/開発者メッセージが最優先であり、矛盾する場合はそちらを優先します。

---

## 最優先ルール（Tier 0）

1. **システム/開発者メッセージの遵守**
   - すべての指示の中で最上位。矛盾があれば必ず優先する。
2. **安全性と権限**
   - 破壊的操作（`rm`、`git reset --hard` 等）はユーザー明示指示がない限り実行しない。
   - サンドボックス外の操作やネットワークアクセスは、必要に応じて承認付きで実行する。
3. **Codex CLI の利用**
   - 実行は `functions.shell_command` を中心に行う。検索は `rg` を優先する。

---

## 基本方針

- **言語**: 既定は日本語。ユーザーの指示があればそれに従う。
- **進め方**: 不明点は確認するが、明確な指示がある場合は途中確認を挟まず完了まで進める。
- **品質**: 変更は最小限で明確に。必要なテストや検証を提案する。

---

## ファイル操作ルール（Windows）

- **相対パスを優先**（作業ディレクトリ基準）。
- 単一ファイル編集は `apply_patch` を優先。
- 文字列置換や大きな書き換えは `shell_command`（PowerShell/Python）で行う。
- 作業範囲外のパスに書き込みが必要な場合は、承認付きで実行する。

---

## 検索・調査

- **リポジトリ内検索**: `rg` を最優先。
- **最新情報が必要な場合**: `web.run` を使用し、公式ドキュメントを優先。
- **引用**: 出典が必要な場合は適切に引用する。

---

## コード作成・編集の指針

- **コメント**: 自明でない処理のみ、簡潔に付与。
- **安全性**: API キーのハードコード禁止。環境変数で管理。
- **型**: TypeScript では `any` を避け、`unknown` を使用。
- **巨大ファイル回避**: 1000 行超は分割を検討。

---

## ツール優先順位（パッケージ管理）

- **bnmp > pnpm > bun > npm**
- `npm`/`npx`/`biome` は環境によって `bnmp` にリダイレクトされる想定。

---

## UI/フレームワーク優先順位

- **GUI**: gpui > egui > Electron/Tauri
- **Web**: TypeScript / Svelte を基本選択

---

## MCP / 連携ツールの扱い

- MCP サーバーがある場合は、それぞれの用途に応じて最小限の利用に留める。
- 追加のスキル（SKILL.md）がある場合は、その指示に従う。

---

## 変更時の運用

- 変更内容は簡潔に要約し、必要な次のステップ（テスト/ビルド等）を提案。
- **自動コミット/自動プッシュは行わない**（ユーザー指示がある場合のみ）。

---

## 参考

- 本ファイルは `CLAUDE.md` を参考に Codex CLI 向けに再構成したものです。
